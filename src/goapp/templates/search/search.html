{{ define "content" }}


<div x-data="SearchData()">
    
        <!--START OF ComboBox -->
        <div>
            
            <label for="search" class="block text-sm font-medium text-gray-700">Search Contributions, Projects, Communities, and People</label>
            <div class="mt-1 flex rounded-md shadow-sm">
              <div class="relative flex items-stretch flex-grow focus-within:z-10">

                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                    <path d="M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z" />
                  </svg>
                </div>
                    <!--
                    @click="searchList.show = !searchList.show"

                    @keyup.enter="alert('Submitted!')"

                    @input.debounce="getSearchResults"

                    @input.enter="getSearchResults()"
                    -->
                  <input @keyup.enter="getSearchResults()" @input.enter="isSearchEmpty()" id="searchList" name="searchList" x-model="form.searchList" type="text" role="input" class="focus:ring-indigo-500 focus:border-indigo-500 block w-full rounded-none rounded-l-md pl-10 sm:text-sm border-gray-300" autocomplete="off">
                  
                  <br><br>
              </div>

                <!--BUTTON-->                <!--BUTTON-->                <!--BUTTON-->                <!--BUTTON-->
              <button @click="getSearchResults()" type="button" class="-ml-px relative inline-flex items-center space-x-2 px-4 py-2 border border-gray-300 text-sm font-medium rounded-r-md text-gray-700 bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500" >

                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                </svg>

                <span>Search</span>
              </button>

            </div>

        </div>
        <!--END OF ComboBox -->
    <br>

    <div>
      <nav class="flex space-x-4" aria-label="Tabs">
        <template x-for="i in SearchBySources">
        <div @click="SelectedSource = i" class="px-3 py-2 font-medium text-sm rounded-md cursor-pointer" x-bind:class="SelectedSource == i ? 'bg-[#fff2eb] text-[#FF5800]':'text-gray-500 hover:text-gray-700'"> 
        <span x-text="i"> </span>
         </div>
        </template>
      </nav>
    </div>

    <div class="overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg">
      <table class="min-w-full divide-y divide-gray-300">
        <thead class="bg-gray-50">
          <tr>
            <!-- TABLE HEADER -->
            <th @click=" " scope="col" class="cursor-pointer py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-[#FF5800] hover:text-gray-700 sm:pl-6 ">Source</th>
            <th @click="GetByName()" scope="col" class="cursor-pointer px-3 py-3.5 text-left text-sm font-semibold text-[#FF5800] ">Name</th>
            <th @click="GetByDescription()" scope="col" class="cursor-pointer px-3 py-3.5 text-left text-sm font-semibold text-[#FF5800] ">Description</th>
          </tr>
        </thead>

        <tbody class="divide-y divide-gray-200 bg-white">
          <template x-for="(results, n) in FilteredSearchBy" >
            <tr>
              <td class="whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6">
                <span x-text="results.Source"></span>
              </td>
              <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500"> 
                <span x-text="results.Name"></span>
              </td>
              <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">
                <span x-text="results.Description"> </span>
              </td>
            </tr>
          </template>
          <!-- More people... -->
        </tbody>
      </table>
    </div>
  
    <br>

    <!-- PAGINATION -->
    <nav class="bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6" aria-label="Pagination">
        <div class="show sm:block" x-for="(i, n) in searchList.data">
            <p class="text-sm text-gray-700">
                Showing
                <span class="font-medium">0</span>
                to
                <span class="font-medium">0</span>
                of
                <span class="font-medium"  x-text="n + 1"></span>
                results
            </p>
        </div>
        <div class="flex justify-between sm:justify-end">
            <a href=" " class="relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50" style="color: #FF5800"> Previous </a>
            <a href=" " class="ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"> Next </a>
        </div>
    </nav>
    <!-- END of PAGINATION -->
    <br><br>
    
</div>

<script type="text/javascript">
    function SearchData() {
              return {
                SearchBy: [],
                SearchBySources: [],
                SelectedSource: 'All',
                form: {
                    searchList: ''
                },
                searchList:{
                    data: []
                },
                getSearchResults() {
                  if (!this.form.searchList == '') {
                    fetch('/search/' + this.form.searchList)
                    .then(r => {
                      r.json().then(body => {
                        this.SearchBy = body
                        console.log(this.SearchBy)
                        this.SearchBySources = ['All']
                        this.SearchBy.map(i => {
                          if(!this.SearchBySources.includes(i.Source)){
                            this.SearchBySources.push(i.Source)
                          }
                        })
                      })
                    })
                  }
                },
                GetAllResults() {
                  fetch('/search/all/')
                  .then(r => {
                    r.json().then(body => {
                      this.SearchBy = body
                      console.log(this.SearchBy)
                    })
                  })
                },
                GetByName() {
                  fetch('/search/name/')
                  .then(r => {
                    r.json().then(body => {
                      this.SearchBy = body
                      console.log(this.SearchBy, "Clicked on Name Tab")
                    })
                  })
                },
                GetByDescription() {
                  fetch('/search/description/')
                  .then(r => {
                    r.json().then(body => {
                      this.SearchBy = body
                      console.log(this.SearchBy, "Clicked on Description Tab")
                    })
                  })
                },
                isSearchEmpty() {
                  if (this.form.searchList == '') {
                    this.GetAllResults()
                  } 
                  return
                },
                get FilteredSearchBy(){
                  if (this.SelectedSource == 'All') {
                    return this.SearchBy
                  } else {
                    return this.SearchBy.filter(i => i.Source == this.SelectedSource)

                  }

                }

      }
    }
</script>


{{ end }}